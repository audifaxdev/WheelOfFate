webpackJsonp([0],[,,function(a,b,c){'use strict';var d=c(0);c.n(d);var e=c(1);c.n(e);let f=c(3)(e);;let g=(j,k,l,m,n,o,p)=>{let q=p/k.length;j.save(),j.translate(l,m),j.rotate(o);for(let r=0;r<k.length;r++)j.save(),j.rotate(r*q),j.fillText(k[r],0,-n),j.restore();j.restore()},h=[{name:'Davo',srcAvatar:'./dist/img/matthew.png',image:null,selected:!0},{name:'Stretcho',srcAvatar:'./dist/img/john.png',image:null,selected:!0},{name:'Davo',srcAvatar:'./dist/img/matthew.png',image:null,selected:!0},{name:'Stretcho',srcAvatar:'./dist/img/john.png',image:null,selected:!0},{name:'Davo',srcAvatar:'./dist/img/matthew.png',image:null,selected:!0}];new class{constructor(){this.animate=()=>{!this.renderer||!this.scene||!this.camera||!this.cannonWorld||(this.controls.update(),this.updatePhysicalWorld(),requestAnimationFrame(this.animate),this.circle,this.renderer.render(this.scene,this.camera))},this.free(),this.init()}free(){this.lights=[],this.scene=null,this.renderer=null,this.camera=null}refresh(){this.drawTexture()}init(){this.mouse=new e.Vector2(0,0),this.mouseUVCoord=new e.Vector2(0,0),this.onClickPosition=new e.Vector2(0,0),this.raycaster=new e.Raycaster,this.scene=new e.Scene,this.fbo=document.createElement('canvas'),this.fbo.width=512,this.fbo.height=512,this.camera=new e.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,10000),this.camera.position.set(100,100,100),this.camera.lookAt(new e.Vector3(0,0,0)),this.renderer=new e.WebGLRenderer,this.renderer.setSize(window.innerWidth,window.innerHeight),this.controls=new f(this.camera,this.renderer.domElement),this.controls.addEventListener('change',this.animate.bind(this));let k=new e.PointLight(16777215);k.position.set(0,20,0),this.scene.add(k);let l=new e.AmbientLight(4473924);this.scene.add(l);let m=new e.DirectionalLight(16772829);m.position.set(0,0,1).normalize(),this.scene.add(m),this.lights.push(k),this.lights.push(l),this.lights.push(m),this.renderer.domElement.addEventListener('mousemove',this.mousemove.bind(this),!1),document.body.appendChild(this.renderer.domElement);let n=new e.CircleGeometry(20,32,0,2*Math.PI);this.texture=new e.CanvasTexture(this.fbo,e.UVMapping,e.RepeatWrapping,e.RepeatWrapping),this.texture.minFilter=e.LinearFilter,this.texture.magFilter=e.LinearFilter,this.texture.format=e.RGBFormat;let o=new e.MeshBasicMaterial({color:16777215,map:this.texture,side:e.DoubleSide});this.circle=new e.Mesh(n,o),this.circle.position.set(0,0,-5),this.scene.add(this.circle),this.gui=new dat.GUI,h.forEach(p=>{this.gui.add(p,'selected').name(p.name).onChange(this.refresh.bind(this))}),this.gui.add({spinWheel:()=>{TweenLite.to(this.circle.rotation,2,{z:'+=10'})}},'spinWheel'),this.setupPhysicalWorld(),this.loadAssets()}setupPhysicalWorld(){this.cannonWorld=new CANNON.World,this.cannonWorld.gravity.set(0,-9.82,0),this.cannonWorld.defaultContactMaterial.contactEquationStiffness=1e11,this.cannonWorld.defaultContactMaterial.contactEquationRelaxation=2;let k=new e.SphereGeometry(1,32,32),l=new e.MeshBasicMaterial({color:16776960});this.ball=new e.Mesh(k,l);let m=new CANNON.Sphere(1);this.sphereBody=new CANNON.Body({mass:5,shape:m}),this.ball.position.set(0,0,0),this.sphereBody.position.set(0,0,0),this.scene.add(this.ball),this.cannonWorld.addBody(this.sphereBody);let n=new CANNON.Material('stone'),o=new CANNON.ContactMaterial(n,n,{friction:0.3,restitution:0.2});this.cannonWorld.addContactMaterial(o);let p=new e.PlaneGeometry(100,100,2,2),q=this.createMesh(p),r=this.createMesh(p),s=new CANNON.Plane,t=new CANNON.Plane,u=new CANNON.Body({mass:0,material:n}),w=new CANNON.Body({mass:0,material:n});u.addShape(s),w.addShape(t),u.quaternion.setFromAxisAngle(new CANNON.Vec3(1,0,0),-Math.PI/2),w.quaternion.setFromAxisAngle(new CANNON.Vec3(0,1,0),-Math.PI/2),u.position.set(0,-10,0),this.syncMeshWithBody(q,u),this.syncMeshWithBody(r,w),this.cannonWorld.addBody(u),this.cannonWorld.addBody(w),this.scene.add(q),this.scene.add(r)}syncMeshWithBody(k,l){k.position.x=l.position.x,k.position.y=l.position.y,k.position.z=l.position.z,k.quaternion.x=l.quaternion.x,k.quaternion.y=l.quaternion.y,k.quaternion.z=l.quaternion.z,k.quaternion.w=l.quaternion.w}loadAssets(){this.loadingManager=new e.LoadingManager(()=>{console.log('loading finnished'),this.drawTexture(),this.animate()}),h.forEach(k=>{k.image=new e.ImageLoader(this.loadingManager).load(k.srcAvatar)})}drawTimeTexture(){let k=this.fbo.getContext('2d'),l=Math.floor(this.fbo.width),m=Math.floor(this.fbo.height),n=5;k.clearRect(0,0,l,m),k.beginPath(),k.arc(l/2,m/2,-n+this.fbo.width/2,0,2*Math.PI,!1),k.fillStyle='blue',k.fill(),k.lineWidth=n,k.strokeStyle='#003300',k.stroke(),k.font='18pt Arial',k.fillStyle='black',k.textAlign='center',k.textBaseline='middle',k.fillText(new Date().toUTCString(),this.fbo.width/2,this.fbo.height/2,this.fbo.width-2*n),this.texture.needsUpdate=!0}drawUvTexture(){let k=Math.floor(this.fbo.width),l=Math.floor(this.fbo.height),m=this.fbo.getContext('2d');m.save(),m.drawImage(this.uvTexture,0,0,k,l),m.restore()}drawCrossAir(){let k=Math.floor(this.fbo.width),l=Math.floor(this.fbo.height),m=this.fbo.getContext('2d');m.save();let n=5;m.fillStyle='red',m.beginPath(),m.rect(k*this.mouseUVCoord.x-n/2,l*this.mouseUVCoord.y-n/2,n,n),m.closePath(),m.fill(),m.restore()}drawTexture(){let k=this.fbo.getContext('2d'),l=Math.floor(this.fbo.width),m=Math.floor(this.fbo.height),n=l/2,o=m/2,p=2,q=c.i(d.filter)(h,w=>w.selected),r=2*Math.PI/q.length;Math.floor(5*Math.random()),k.clearRect(0,0,l,m),k.lineWidth=p,k.strokeStyle='#003300';let s=0,t=(.5-this.mouseUVCoord.x)*(.5-this.mouseUVCoord.x)+(.5-this.mouseUVCoord.y)*(.5-this.mouseUVCoord.y)<=.5*.5,u=Math.atan2(this.mouseUVCoord.y-.5,this.mouseUVCoord.x-.5);0>u&&(u=u+2*Math.PI),1<q.length&&q.forEach(w=>{let z=s*r<=u&&u<=(s+1)*r,A=t&&z?'red':'blue',B=s*r,C=(s+1)*r;k.save(),k.fillStyle=A,k.beginPath(),k.moveTo(n,o),k.arc(n,o,-p+n,B,C),k.lineTo(n,o),k.closePath(),k.fill(),k.stroke(),k.restore(),k.save(),k.translate(n,o),k.rotate(B+r/2+Math.PI/2),k.drawImage(w.image,-35,-o+15,70,70),k.restore(),g(k,w.name,n,o,-30-p+n,s*r-r/2,r),s++}),this.texture.needsUpdate=!0}mousemove(k){k.preventDefault();let l=this.getMousePosition(this.renderer.domElement,k.clientX,k.clientY);this.onClickPosition.fromArray(l);let m=this.getIntersects(this.onClickPosition,this.scene.children);if(0<m.length&&m[0].uv){let o=m[0].uv;m[0].object.material.map.transformUv(o),this.mouseUVCoord.set(o.x,o.y)}else this.mouseUVCoord.set(0,0);let n=Math.atan2(this.mouseUVCoord.y-.5,this.mouseUVCoord.x-.5);0>n&&(n=n+2*Math.PI),this.drawTexture()}getMousePosition(k,l,m){let n=k.getBoundingClientRect();return[(l-n.left)/n.width,(m-n.top)/n.height]}getIntersects(k,l){return this.mouse.set(2*k.x-1,-(2*k.y)+1),this.raycaster.setFromCamera(this.mouse,this.camera),this.raycaster.intersectObjects(l)}createMesh(k){let l=new e.MeshNormalMaterial;l.side=e.DoubleSide;let m=new e.MeshBasicMaterial;m.wireframe=!0;let n=e.SceneUtils.createMultiMaterialObject(k,[m]);return n}updatePhysicalWorld(){let k=new Date().getTime(),l=(k-this.lastTick)/1000;this.cannonWorld.step(1/600,l,3),this.ball.position.x=this.sphereBody.position.x,this.ball.position.y=this.sphereBody.position.y,this.ball.position.z=this.sphereBody.position.z,this.ball.quaternion.x=this.sphereBody.quaternion.x,this.ball.quaternion.y=this.sphereBody.quaternion.y,this.ball.quaternion.z=this.sphereBody.quaternion.z,this.ball.quaternion.w=this.sphereBody.quaternion.w,this.lastTick=k}}},function(a,b){a.exports=function(c){function d(e,f){function g(){return 2*Math.PI/60/60*P.autoRotateSpeed}function h(){return Math.pow(0.95,P.zoomSpeed)}function j(la){X.theta-=la}function k(la){X.phi-=la}function l(la){P.object instanceof c.PerspectiveCamera?Y/=la:P.object instanceof c.OrthographicCamera?(P.object.zoom=Math.max(P.minZoom,Math.min(P.maxZoom,P.object.zoom*la)),P.object.updateProjectionMatrix(),$=!0):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'),P.enableZoom=!1)}function m(la){P.object instanceof c.PerspectiveCamera?Y*=la:P.object instanceof c.OrthographicCamera?(P.object.zoom=Math.max(P.minZoom,Math.min(P.maxZoom,P.object.zoom/la)),P.object.updateProjectionMatrix(),$=!0):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'),P.enableZoom=!1)}function n(la){_.set(la.clientX,la.clientY)}function o(la){fa.set(la.clientX,la.clientY)}function p(la){ca.set(la.clientX,la.clientY)}function q(la){aa.set(la.clientX,la.clientY),ba.subVectors(aa,_);var ma=P.domElement===document?P.domElement.body:P.domElement;j(2*Math.PI*ba.x/ma.clientWidth*P.rotateSpeed),k(2*Math.PI*ba.y/ma.clientHeight*P.rotateSpeed),_.copy(aa),P.update()}function r(la){ga.set(la.clientX,la.clientY),ha.subVectors(ga,fa),0<ha.y?l(h()):0>ha.y&&m(h()),fa.copy(ga),P.update()}function s(la){da.set(la.clientX,la.clientY),ea.subVectors(da,ca),ka(ea.x,ea.y),ca.copy(da),P.update()}function t(la){}function u(la){0>la.deltaY?m(h()):0<la.deltaY&&l(h()),P.update()}function w(la){switch(la.keyCode){case P.keys.UP:ka(0,P.keyPanSpeed),P.update();break;case P.keys.BOTTOM:ka(0,-P.keyPanSpeed),P.update();break;case P.keys.LEFT:ka(P.keyPanSpeed,0),P.update();break;case P.keys.RIGHT:ka(-P.keyPanSpeed,0),P.update();}}function z(la){_.set(la.touches[0].pageX,la.touches[0].pageY)}function A(la){var ma=la.touches[0].pageX-la.touches[1].pageX,na=la.touches[0].pageY-la.touches[1].pageY,oa=Math.sqrt(ma*ma+na*na);fa.set(0,oa)}function B(la){ca.set(la.touches[0].pageX,la.touches[0].pageY)}function C(la){aa.set(la.touches[0].pageX,la.touches[0].pageY),ba.subVectors(aa,_);var ma=P.domElement===document?P.domElement.body:P.domElement;j(2*Math.PI*ba.x/ma.clientWidth*P.rotateSpeed),k(2*Math.PI*ba.y/ma.clientHeight*P.rotateSpeed),_.copy(aa),P.update()}function D(la){var ma=la.touches[0].pageX-la.touches[1].pageX,na=la.touches[0].pageY-la.touches[1].pageY,oa=Math.sqrt(ma*ma+na*na);ga.set(0,oa),ha.subVectors(ga,fa),0<ha.y?m(h()):0>ha.y&&l(h()),fa.copy(ga),P.update()}function E(la){da.set(la.touches[0].pageX,la.touches[0].pageY),ea.subVectors(da,ca),ka(ea.x,ea.y),ca.copy(da),P.update()}function F(la){}function G(la){if(!1!==P.enabled){if(la.preventDefault(),la.button===P.mouseButtons.ORBIT){if(!1===P.enableRotate)return;n(la),U=T.ROTATE}else if(la.button===P.mouseButtons.ZOOM){if(!1===P.enableZoom)return;o(la),U=T.DOLLY}else if(la.button===P.mouseButtons.PAN){if(!1===P.enablePan)return;p(la),U=T.PAN}U!==T.NONE&&(document.addEventListener('mousemove',H,!1),document.addEventListener('mouseup',I,!1),P.dispatchEvent(R))}}function H(la){if(!1!==P.enabled)if(la.preventDefault(),U===T.ROTATE){if(!1===P.enableRotate)return;q(la)}else if(U===T.DOLLY){if(!1===P.enableZoom)return;r(la)}else if(U===T.PAN){if(!1===P.enablePan)return;s(la)}}function I(la){!1===P.enabled||(t(la),document.removeEventListener('mousemove',H,!1),document.removeEventListener('mouseup',I,!1),P.dispatchEvent(S),U=T.NONE)}function J(la){!1===P.enabled||!1===P.enableZoom||U!==T.NONE&&U!==T.ROTATE||(la.preventDefault(),la.stopPropagation(),u(la),P.dispatchEvent(R),P.dispatchEvent(S))}function K(la){!1===P.enabled||!1===P.enableKeys||!1===P.enablePan||w(la)}function L(la){if(!1!==P.enabled){switch(la.touches.length){case 1:if(!1===P.enableRotate)return;z(la),U=T.TOUCH_ROTATE;break;case 2:if(!1===P.enableZoom)return;A(la),U=T.TOUCH_DOLLY;break;case 3:if(!1===P.enablePan)return;B(la),U=T.TOUCH_PAN;break;default:U=T.NONE;}U!==T.NONE&&P.dispatchEvent(R)}}function M(la){if(!1!==P.enabled)switch(la.preventDefault(),la.stopPropagation(),la.touches.length){case 1:if(!1===P.enableRotate)return;if(U!==T.TOUCH_ROTATE)return;C(la);break;case 2:if(!1===P.enableZoom)return;if(U!==T.TOUCH_DOLLY)return;D(la);break;case 3:if(!1===P.enablePan)return;if(U!==T.TOUCH_PAN)return;E(la);break;default:U=T.NONE;}}function N(la){!1===P.enabled||(F(la),P.dispatchEvent(S),U=T.NONE)}function O(la){la.preventDefault()}this.object=e,this.domElement=void 0===f?document:f,this.enabled=!0,this.target=new c.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=0.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:c.MOUSE.LEFT,ZOOM:c.MOUSE.MIDDLE,PAN:c.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return W.phi},this.getAzimuthalAngle=function(){return W.theta},this.reset=function(){P.target.copy(P.target0),P.object.position.copy(P.position0),P.object.zoom=P.zoom0,P.object.updateProjectionMatrix(),P.dispatchEvent(Q),P.update(),U=T.NONE},this.update=function(){var la=new c.Vector3,ma=new c.Quaternion().setFromUnitVectors(e.up,new c.Vector3(0,1,0)),na=ma.clone().inverse(),oa=new c.Vector3,pa=new c.Quaternion;return function(){var ra=P.object.position;return la.copy(ra).sub(P.target),la.applyQuaternion(ma),W.setFromVector3(la),P.autoRotate&&U===T.NONE&&j(g()),W.theta+=X.theta,W.phi+=X.phi,W.theta=Math.max(P.minAzimuthAngle,Math.min(P.maxAzimuthAngle,W.theta)),W.phi=Math.max(P.minPolarAngle,Math.min(P.maxPolarAngle,W.phi)),W.makeSafe(),W.radius*=Y,W.radius=Math.max(P.minDistance,Math.min(P.maxDistance,W.radius)),P.target.add(Z),la.setFromSpherical(W),la.applyQuaternion(na),ra.copy(P.target).add(la),P.object.lookAt(P.target),!0===P.enableDamping?(X.theta*=1-P.dampingFactor,X.phi*=1-P.dampingFactor):X.set(0,0,0),Y=1,Z.set(0,0,0),$||oa.distanceToSquared(P.object.position)>V||8*(1-pa.dot(P.object.quaternion))>V}}(),this.dispose=function(){P.domElement.removeEventListener('contextmenu',O,!1),P.domElement.removeEventListener('mousedown',G,!1),P.domElement.removeEventListener('wheel',J,!1),P.domElement.removeEventListener('touchstart',L,!1),P.domElement.removeEventListener('touchend',N,!1),P.domElement.removeEventListener('touchmove',M,!1),document.removeEventListener('mousemove',H,!1),document.removeEventListener('mouseup',I,!1),window.removeEventListener('keydown',K,!1)};var P=this,Q={type:'change'},R={type:'start'},S={type:'end'},T={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},U=T.NONE,V=0.000001,W=new c.Spherical,X=new c.Spherical,Y=1,Z=new c.Vector3,$=!1,_=new c.Vector2,aa=new c.Vector2,ba=new c.Vector2,ca=new c.Vector2,da=new c.Vector2,ea=new c.Vector2,fa=new c.Vector2,ga=new c.Vector2,ha=new c.Vector2,ia=function(){var la=new c.Vector3;return function(na,oa){la.setFromMatrixColumn(oa,0),la.multiplyScalar(-na),Z.add(la)}}(),ja=function(){var la=new c.Vector3;return function(na,oa){la.setFromMatrixColumn(oa,1),la.multiplyScalar(na),Z.add(la)}}(),ka=function(){var la=new c.Vector3;return function(na,oa){var pa=P.domElement===document?P.domElement.body:P.domElement;if(P.object instanceof c.PerspectiveCamera){var qa=P.object.position;la.copy(qa).sub(P.target);var ra=la.length();ra*=Math.tan(P.object.fov/2*Math.PI/180),ia(2*na*ra/pa.clientHeight,P.object.matrix),ja(2*oa*ra/pa.clientHeight,P.object.matrix)}else P.object instanceof c.OrthographicCamera?(ia(na*(P.object.right-P.object.left)/P.object.zoom/pa.clientWidth,P.object.matrix),ja(oa*(P.object.top-P.object.bottom)/P.object.zoom/pa.clientHeight,P.object.matrix)):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.'),P.enablePan=!1)}}();P.domElement.addEventListener('contextmenu',O,!1),P.domElement.addEventListener('mousedown',G,!1),P.domElement.addEventListener('wheel',J,!1),P.domElement.addEventListener('touchstart',L,!1),P.domElement.addEventListener('touchend',N,!1),P.domElement.addEventListener('touchmove',M,!1),window.addEventListener('keydown',K,!1),this.update()};return d.prototype=Object.create(c.EventDispatcher.prototype),d.prototype.constructor=d,Object.defineProperties(d.prototype,{center:{get:function(){return console.warn('THREE.OrbitControls: .center has been renamed to .target'),this.target}},noZoom:{get:function(){return console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.'),!this.enableZoom},set:function(e){console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.'),this.enableZoom=!e}},noRotate:{get:function(){return console.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'),!this.enableRotate},set:function(e){console.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'),this.enableRotate=!e}},noPan:{get:function(){return console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.'),!this.enablePan},set:function(e){console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.'),this.enablePan=!e}},noKeys:{get:function(){return console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.'),!this.enableKeys},set:function(e){console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.'),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'),!this.enableDamping},set:function(e){console.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn('THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'),this.dampingFactor},set:function(e){console.warn('THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'),this.dampingFactor=e}}}),d}},,,function(a,b,c){a.exports=c(2)}],[6]);
